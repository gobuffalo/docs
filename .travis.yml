sudo: required

install: false

stages:
  - test
  - name: deploy
    if: branch = master

jobs:
  include:
    - stage: test
      go: 1.9
      install: go get -t -v ./...
      script: go test -v ./...
    - stage: deploy
      services:
        - docker
      addons:
        apt:
          update: true
          packages:
            - docker-ce
      script: echo $HEROKU_TOKEN
      after_success:
        - ./travis-deploy.sh